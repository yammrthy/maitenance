<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Report Form</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    /* Add your CSS styles here */
  </style>
</head>
<body>
  <div class="form-container">
    <h2>Report Form</h2>
    <form id="reportForm">
      <label for="vehicleID">Vehicle ID</label>
      <input type="text" id="vehicleID" name="vehicleID" required />
      
      <label for="registrationNumber">Registration Number</label>
      <input type="text" id="registrationNumber" name="registrationNumber" />
      
      <label for="vehicleIn">Vehicle IN (Date)</label>
      <input type="date" id="vehicleIn" name="vehicleIn" required />
      
      <label for="noOfDays">No of Days</label>
      <input type="number" id="noOfDays" name="noOfDays" required />
      
      <label for="problemIdentification">Problem Identification</label>
      <textarea id="problemIdentification" name="problemIdentification" required></textarea>
      
      <label for="sparesStatus">Spares Status</label>
      <input type="text" id="sparesStatus" name="sparesStatus" required />
      
      <label for="maintenanceIncharge">Maintenance Incharge</label>
      <input type="text" id="maintenanceIncharge" name="maintenanceIncharge" required />
      
      <label for="userDeptContact">User Dept Contact</label>
      <input type="text" id="userDeptContact" name="userDeptContact" required />
      
      <input type="submit" value="Submit" />
    </form>
  </div>

  <script>
    document.getElementById("reportForm").addEventListener("submit", function (event) {
      event.preventDefault();

      const vehicleID = document.getElementById("vehicleID").value.trim();
      const vehicleIn = document.getElementById("vehicleIn").value.trim();
      const noOfDays = document.getElementById("noOfDays").value.trim();
      const problemIdentification = document.getElementById("problemIdentification").value.trim();
      const sparesStatus = document.getElementById("sparesStatus").value.trim();
      const maintenanceIncharge = document.getElementById("maintenanceIncharge").value.trim();
      const userDeptContact = document.getElementById("userDeptContact").value.trim();

      const newEntry = {
        vehicleID,
        vehicleIn,
        noOfDays,
        problemIdentification,
        sparesStatus,
        maintenanceIncharge,
        userDeptContact,
      };

      // Retrieve existing data
      let reports = JSON.parse(localStorage.getItem("reports")) || [];
      reports.push(newEntry);
      
      // Save the updated data back to localStorage
      localStorage.setItem("reports", JSON.stringify(reports));

      // Show notification
      if (Notification.permission === "granted") {
        new Notification("âœ… New Report Submitted", {
          body: `New report for vehicle ${vehicleID} has been added.`,
          icon: "https://cdn-icons-png.flaticon.com/512/190/190411.png"
        });
      }

      // Display a confirmation message
      alert("Report submitted successfully!");

      // Redirect to report page
      window.location.href = "report.html";
    });

    // Check notification permission on page load
    if (Notification.permission !== "granted") {
      Notification.requestPermission();
    }
  </script>
</body>
</html>
